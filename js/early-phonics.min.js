/*! doorway-early-phonics 01-02-2019 */

function setCookie(e,t,i){var o=new Date;o.setTime(o.getTime()+24*i*60*60*1e3);var n="expires="+o.toUTCString();document.cookie=e+"="+t+";"+n+";path=/"}function getCookie(e){for(var t=e+"=",i=document.cookie.split(";"),o=0;o<i.length;o++){for(var n=i[o];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return""}function delCookie(e){document.cookie=e+"=; expires=Mon, 01 Jan 1990 00:00:00 UTC; path=/;"}function getKeys(){var e="abcdefghijklmnopqrstuvwxyz",t=sessionStorage.getItem("currentImage").split("").filter(function(e,t,i){return i.indexOf(e)===t}),o=[];for(i=0;i<t.length;i++)o.push(t[i]);for(;o.length<8;){var n=e.charAt(Math.floor(Math.random()*e.length));duplicate(n,o)||o.push(n)}var s=shuffle(o),c=0;for(i=0;i<keyboard_res.length;i++)for(j=0;j<4;j++)keyboard_res[i].keys[j].key=s[c],c++}function shuffle(e){for(var t,i,o=e.length;0!==o;)i=Math.floor(Math.random()*o),t=e[o-=1],e[o]=e[i],e[i]=t;return e}function LoadResults(){var e=JSON.parse(sessionStorage.getItem("tries")),t=document.getElementById("resultsTable1").getElementsByTagName("tbody")[0],o=0,n=0;for(i=0;i<e.length;i++){10==i&&(o=0,$("#resultsTable2").show(),t=document.getElementById("resultsTable2").getElementsByTagName("tbody")[0]);var s=t.insertRow(o),c=s.insertCell(0),l=s.insertCell(1),r=s.insertCell(2),d=s.insertCell(3);c.className="score_sheet_star",d.className="score_sheet_star",l.className="text-center",r.className="text-center";var a=document.createElement("IMG"),h=document.createElement("IMG");a.setAttribute("src","resources/icons/scoresheet-star.svg"),h.setAttribute("src","resources/icons/scoresheet-star.svg"),c.appendChild(a),d.appendChild(h);var p=document.createTextNode(e[i][0]);l.appendChild(p);var u=document.createTextNode(e[i][1]);r.appendChild(u),o++,n+=e[i][1]}var m=e.length,f=(m/n*100).toFixed(1);"testing"===getCookie("InputCookie")&&$("#running_total").html("Total = "+f+"% | Words ("+m+") Tries ("+n+")")}function onLoad(e,t,o){var n=$(t).find(o);for(i=0;i<n.length;i++)$(n[i]).val&&$(n[i]).val(""),$(n[i]).text&&$(n[i]).text("");for(i=0;i<e.length;i++)$(n[i]).val&&$(n[i]).val(e[i]),$(n[i]).text&&$(n[i]).text(e[i])}function onLoadPage(e,t,o,n){var s=$(t).find(o);for(i=0;i<s.length;i++)i+16*n>e.length-1?$(s[i]).css("visibility","hidden"):($(s[i]).val&&$(s[i]).val(e[i+16*n]),$(s[i]).text&&$(s[i]).text(e[i+16*n]))}function Resizing(){this.onResize=function(){var e=this.aspectDiv.clientWidth;this.oneEm=e/50,this.aspectDiv.style.fontSize=this.oneEm+"px"},this.aspectDiv=document.getElementById("dwAspectDiv"),this.aspectDiv&&(window.addEventListener("resize",this.onResize.bind(this)),this.onResize("no-event"))}var timer;function startScanning(){if(switchIsOn){if("restricted"==keyboard_select)var t=[document.getElementsByClassName("zeroRow"),document.getElementsByClassName("twelve columns")[0].children,document.getElementsByClassName("twelve columns")[1].children];else t=[document.getElementsByClassName("zeroRow"),document.getElementsByClassName("twelve columns")[0].children,document.getElementsByClassName("twelve columns")[1].children,document.getElementsByClassName("twelve columns")[2].children];twoSwitches?twoSwitch(t):document.body.onkeyup=function(e){32==e.keyCode&&oneSwitch(timeSwitch,t)}}}function stopScanning(){switchIsOn&&null!=timer&&clearTimeout(timer)}function removeSelected(e){for(var t=0;t<e.length;t++)e[t].classList.remove("selected")}function addSelected(e){for(var t=0;t<e.length;t++)e[t].classList.add("selected")}function oneSwitch(t,i){var o=!1,n=0,s=[-1,0];!function e(){document.body.onkeyup=function(e){32==e.keyCode&&(o?(i[s[0]][s[1]].click(),removeSelected(i[s[0]]),s=[n=0,0],o=!1):(o=!0,n=1,removeSelected(i[s[0]]),s[1]=-1))},-1!=s[0]&&removeSelected(i[s[0]]),-1==s[0]?s[0]++:s[0]!=i.length-1||o?s[1]==i[s[0]].length-1?s[0]==i[s[0]].length?s[0]=0:(s[1]=0,o=!1,s[n=0]++):s[n]++:s[0]=0,o?i[s[0]][s[1]].classList.add("selected"):addSelected(i[s[0]]),timer=setTimeout(e,1e3*t)}()}function twoSwitch(t){var i=!0,o=-1,n=0;document.body.onkeyup=function(e){32==e.keyCode&&i?(-1!=o&&removeSelected(t[o]),o==t.length-1?o=0:o++,addSelected(t[o])):13==e.keyCode&&i?(i=!1,removeSelected(t[o]),t[o][0].classList.add("selected")):32!=e.keyCode||i?13!=e.keyCode||i||t[o][n].click():(t[o][n].classList.remove("selected"),n==t[o].length-1?(i=!(n=0),addSelected(t[o])):(n++,t[o][n].classList.add("selected")))}}function selectionPageLoaded(){var e=sessionStorage.getItem("wordlist").split(",");onLoadPage(e,"#pills-home","button",0),onLoadPage(e,"#pills-profile","button",1);var t=[];sessionStorage.setItem("choices",t),document.getElementById("nextBtn").hidden=!0,$("#option1").click(function(){$("#select").find("button").each(function(){$(this).text("")}),t=generateWords(5,e),sessionStorage.setItem("choices",t),document.getElementById("nextBtn").hidden=!1,onLoad(t,"#select","input"),$("#pills-home , #pills-profile, #pills-profile2, #pills-profile3, #pills-profile4").find("button").prop("disabled",!1)}),$("#option3").click(function(){t=generateWords(10,e),sessionStorage.setItem("choices",t),document.getElementById("nextBtn").hidden=!1,onLoad(t,"#select","input"),$("#pills-home , #pills-profile, #pills-profile2, #pills-profile3, #pills-profile4").find("button").prop("disabled",!1)}),$("#option2").click(function(){t=generateWords(20,e),sessionStorage.setItem("choices",t),document.getElementById("nextBtn").hidden=!1,onLoad(t,"#select","input"),$("#pills-home , #pills-profile, #pills-profile2, #pills-profile3, #pills-profile4").find("button").prop("disabled",!0)}),$("#pills-home , #pills-profile, #pills-profile2, #pills-profile3, #pills-profile4").find("button").click(function(){tried=$(this).text(),duplicate(tried,t)||(20!=t.length?(t.push(tried),sessionStorage.setItem("choices",t),document.getElementById("nextBtn").hidden=!1,20==t.length&&$("#pills-home , #pills-profile, #pills-profile2, #pills-profile3, #pills-profile4").find("button").prop("disabled",!0),onLoad(t,"#select","input")):$("#pills-home , #pills-profile, #pills-profile2, #pills-profile3, #pills-profile4").find("button").prop("disabled",!0))});var i=0;$("#select").find("input").each(function(){$("#pills-home , #pills-profile, #pills-profile2, #pills-profile3, #pills-profile4").find("button").prop("disabled",!1),$(this).attr("id",i),i+=1}),$("#select").find("input").click(function(){t.splice($(this).attr("id"),1),onLoad(t,"#select","input"),$("#pills-home , #pills-profile, #pills-profile2, #pills-profile3, #pills-profile4").find("button").prop("disabled",!1),sessionStorage.setItem("choices",t),0==t.length&&(document.getElementById("nextBtn").hidden=!0)}),$(".word-button.chosen").on("mousedown",function(e){e.preventDefault(),$(this).addClass("removeWord")}).on("mouseup",function(){$(this).removeClass("removeWord")}),$(".word-button").on("mousedown",function(e){e.preventDefault(),$(this).addClass("selectWord")}).on("mouseup",function(){$(this).removeClass("selectWord")})}function generateWords(e,t){for(var o=[],n=[];n.length<e;){var s=Math.floor(Math.random()*t.length);-1===n.indexOf(s)&&n.push(s)}for(i=0;i<n.length;i++)o.push(t[n[i]]);return o}function duplicate(e,t){for(i=0;i<t.length;i++)if(t[i]==e)return!0;return!1}function changeInfoText(e){var t=document.getElementById("mode_info");"testing"==e?t.innerHTML="Word Hidden":"learning"==e&&(t.innerHTML="Word Shown")}function changeInfoTextKeyboard(e){var t=document.getElementById("scanning_select"),i=document.getElementById("scanning_settings");"scanning"==e&&(t.style.visibility="hidden",i.style.visibility="visible")}function changeInfoTextSwitch(e){var t=document.getElementById("switch_info");"one"==e?t.innerHTML="Press switch or space to select.":"two"==e&&(t.innerHTML="Press left switch or space to move and right switch or enter to select.")}var keyboard_select="restricted",coloured_keys=!0,mode_select="testing",switchIsOn=!1,timeSwitch=2,twoSwitches=!0,wordlist=[""];function chooseWordList(){document.getElementById("words_input").checked?(wordlist=["bag","bed","bin","box","can","cap","cat","dog","fan","fox","hat","hen","jam","jug","leg","man","map","men","mug","net","pan","peg","pen","pig","rat","red","sun","tap","ten","van","web","zip"],setCookie("GameTypeCookie","words_input",2),$("#activity_info").html("(CVC words)")):document.getElementById("blends_input").checked?(wordlist=["ant","belt","brush","bulb","clap","crab","desk","drum","fist","flag","flask","frog","gift","golf","green","hand","lamp","milk","nest","plug","pram","raft","shelf","spoon","stamp","stop","string","swim","swing","tent","tree"],setCookie("GameTypeCookie","blends_input",2),$("#activity_info").html("(words with adjacent consonants)")):document.getElementById("digraphs_input").checked?(wordlist=["bath","bee","book","boot","chin","cook","feet","fish","food","foot","good","heel","hood","hoof","hook","jeep","king","loop","moon","path","peek","peel","pool","queen","ring","roof","ship","string","swing","weed","wood","wool"],setCookie("GameTypeCookie","digraphs_input",2),$("#activity_info").html("(ee, oo, th, ch, sh, ng)")):document.getElementById("moredigraphs_input").checked?(wordlist=["car","chain","chick","cloud","coat","coin","cue","dart","egg","fork","goat","hair","horn","ill","jar","kerb","mouth","nail","oil","pie","pink","rain","road","shark","shell","snail","sock","star","tail","tank","tie","train"],setCookie("GameTypeCookie","moredigraphs_input",2),$("#activity_info").html("(other digraphs)")):(wordlist=[""],setCookie("GameTypeCookie","",2)),sessionStorage.setItem("wordlist",wordlist)}function getSettingsValues(){input_cookie_in=getCookie("InputCookie"),""!==input_cookie_in?(mode_select=input_cookie_in,$(".input_mode[value="+input_cookie_in+"]").prop("checked",!0),"learning"==input_cookie_in?$("#mode_info").html("(Words shown)"):$("#mode_info").html("(Words hidden)")):setCookie("InputCookie",$(".input_mode").attr("value"),1),key_cookie_in=getCookie("KeyboardCookie"),""!==key_cookie_in?(keyboard_select=key_cookie_in,$(".keyboard_mode[value="+key_cookie_in+"]").prop("checked",!0),"restricted"==key_cookie_in&&($("#keyboard_info").html("(Fewer keys)"),$(".colour_key_div").hide()),$("#colour_keys_off").prop("checked",!0),coloured_keys=!1):keyboard_select="standard"==$(".keyboard_mode:checked").val()?"standard":"restricted",coloured_keys="true"==$(".colour_mode:checked").val(),game_type_cookie=getCookie("GameTypeCookie"),""!==game_type_cookie&&$("#"+game_type_cookie).prop("checked",!0),chooseWordList()}function demoSettings(){twoSwitches=!(switchIsOn=!(timeSwitch=2)),$(".input_mode").click(function(){var e=$(this).attr("value");"testing"==e?$("#mode_info").html("(Words hidden)"):"learning"==e&&$("#mode_info").html("(Words shown)"),setCookie("InputCookie",e,1)}),$(".keyboard_mode").click(function(){var e=$(this).attr("value");"standard"==e?($("#keyboard_info").html("(Standard keyboard with all keys)"),$(".colour_key_div").show(),$("#colour_keys_off").prop("checked",!0),coloured_keys=!(keyboard_select="standard")):"restricted"==e&&($("#keyboard_info").html("(Fewer keys)"),$(".colour_key_div").hide(),$("#colour_keys_off").prop("checked",!0),coloured_keys=!1,keyboard_select="restricted"),setCookie("KeyboardCookie",e,1)}),$(".switch_mode").click(function(){var e=$(this).attr("value");"true"==e?($(".switch_num_div").show(),$("#radio-switches-2").prop("checked",!0),switchIsOn=!0,twoSwtiches=!0):"false"==e&&($(".switch_num_div").hide(),$(".switch_time_div").hide(),$("#radio-switches-2").prop("checked",!1),$("#time-switches-1").prop("checked",!1),$("#time-switches-2").prop("checked",!1),$("#time-switches-3").prop("checked",!1),switchIsOn=!1,twoSwtiches=!1)}),$(".switch_number").click(function(){var e=$(this).attr("value");"1"==e?($(".switch_time_div").show(),$("#time-switches-2").prop("checked",!0),twoSwitches=!1,timeSwitch=2):"2"==e&&($(".switch_time_div").hide(),$("#time-switches-1").prop("checked",!1),$("#time-switches-2").prop("checked",!1),$("#time-switches-3").prop("checked",!1),twoSwitches=!0,timeSwitch=null)}),$(".switch_time").click(function(){var e=$(this).attr("value");"1s"==e?($("#time-switches-1").prop("checked",!0),$("#time-switches-2").prop("checked",!1),$("#time-switches-3").prop("checked",!1),timeSwitch=1):"2s"==e?($("#time-switches-2").prop("checked",!0),$("#time-switches-1").prop("checked",!1),$("#time-switches-3").prop("checked",!1),timeSwitch=2):"3s"==e&&($("#time-switches-3").prop("checked",!0),$("#time-switches-1").prop("checked",!1),$("#time-switches-2").prop("checked",!1),timeSwitch=3)}),$(".colour_mode").click(function(){var e=$(this).attr("value");"true"==e?coloured_keys=!0:"false"==e&&(coloured_keys=!1)}),$("#game_type").click(function(){chooseWordList()})}function isMobileDevice(){return/Android|webOS|iPhone|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)?(console.log("Mobile Device"),!0):(console.log("Not Mobile Device"),!1)}function StartGame(t,i){document.getElementById("nextBtn").hidden=!0;var o=document.getElementById("word-audio"),n=document.getElementById("correct-audio"),s=document.getElementById("modal"),e=sessionStorage.getItem("choices");choices=e.split(",");var c=choices.pop();if(sessionStorage.setItem("choices",choices),void 0===t&&void 0===i)t=new Array(choices.length),i=0;else t=t,i=i;var l=function(){-1!==o.src.indexOf("resources/sounds/spelltheword.mp3")&&(o.src="resources/sounds/"+c+".mp3",o.play())};document.getElementById("img-random").src="resources/images/"+c+".svg",sessionStorage.setItem("currentImage",c),o.src="resources/sounds/spelltheword.mp3",o.addEventListener("ended",l),o.play(),"learning"==getCookie("InputCookie")?document.getElementById("word-text").innerHTML=c:$("#spell-word").css("margin-top","2.75em"),document.getElementById("check-button").onclick=function(){if(inputToCheck=document.getElementById("write").value,inputToCheck==c)if(document.getElementById("write").value="",void 0===t[i]?t[i]=[c,1]:t[i][1]++,i++,0<choices.length){o.removeEventListener("ended",l),s.innerHTML="Correct!",s.style.display="block";var e=function(){s.style.display="none",StartGame(t,i),LoadKeyboard(),startScanning(),stopScanning(),n.removeEventListener("ended",e)};n.addEventListener("ended",e),n.play()}else{stopScanning(),sessionStorage.setItem("tries",JSON.stringify(t)),s.innerHTML="Correct!",s.style.display="block";e=function(){s.style.display="none",window.LoadResultsPage(),n.removeEventListener("ended",e)};n.addEventListener("ended",e),n.play(),LoadResultsPage()}else stopScanning(),startScanning(),s.innerHTML="Try again!",s.style.display="block",setTimeout(function(){s.style.display="none",$("#write").val("")},1e3),void 0===t[i]?t[i]=[c,1]:t[i][1]++},isMobileDevice(),$("#write").focus(function(){isMobileDevice()&&$(".keyboard").hide()}),$("#write").focusout(function(){isMobileDevice()&&$(".keyboard").show()})}